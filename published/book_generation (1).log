 INFO book_generator_log: in Manifest::pull_book_repo.  Rails env = production
 INFO book_generator_log: Pulling the book repo
 INFO book_generator_log: repo does not exist on the book generator.  Cloning it.
 INFO book_generator_log: Cloning /var/lpub/shared/book_repos/nodebeginner.
 INFO book_generator_log: [git] cloning repository (source: app@leanpub.com:/var/lpub/shared/book_repos/nodebeginner, destination: /var/lpub/shared/book_repos/nodebeginner)
DEBUG book_generator_log: [git] reading manuscript/Book.txt (path: /var/lpub/shared/book_repos/nodebeginner)
 INFO book_generator_log: fixing images.
 INFO book_generator_log: fixing all image problems
 INFO book_generator_log: getting image list
 INFO book_generator_log: getting image list for wholebook.html
 INFO book_generator_log: getting image data
 INFO book_generator_log: dealing with bad images
 INFO book_generator_log: #deal_with_bad_images, failed_images = 
{}
 INFO book_generator_log: changing image srcs
 INFO book_generator_log: @img_src_translations:
{}
DEBUG book_generator_log: generating with params: {:email_readers=>false, :release_notes=>nil, :page_size=>"a5paper", :warnings=>[], :request_id=>"28e3f7f0-8d06-012e-ec72-12313f007502", :subtitle=>"A comprehensive Node.js tutorial", :input_format=>"html", :author_string=>"Manuel Kiessling", :topic=>"book.build.generate", :break_after_section=>false, :slug=>"nodebeginner", :requested_at=>"2011-07-10T09:37:32+00:00", :preview=>false, :title=>"The Node Beginner Book"}
 INFO book_generator_log: generating a PDF with filename: nodebeginner.pdf, sample: false
 INFO book_generator_log: generating latex
 INFO book_generator_log: cd /var/lpub/shared/book_repos/nodebeginner/html_bodies_latex && /var/lpub/usr/local/bin/pandoc --standalone --toc --from=markdown --to=latex  --output=/var/lpub/shared/book_repos/nodebeginner/html_bodies_latex/book-full.tex --template=/var/lpub/releases/20110709211220/book_generator/pandoc_templates/latex_template.tex --variable="assets_path:/var/lpub/releases/20110709211220/book_generator/assets" --variable="author:Manuel Kiessling" --variable="page_size:a5paper" --variable="subtitle:A comprehensive Node.js tutorial" --variable="title_page_image:/var/lpub/shared/book_repos/nodebeginner/manuscript/images/title_page.png" --variable="date:Sun Jul 10 09:42:20 +0000 2011" --variable="title:The Node Beginner Book" /var/lpub/shared/book_repos/nodebeginner/html_bodies_latex/book-includes.tex
 INFO book_generator_log: book-full.tex (/var/lpub/shared/book_repos/nodebeginner/html_bodies_latex/book-full.tex):
\documentclass[oneside,a5paper]{book}

%% xetex setup
\usepackage{fontspec,xltxtra,xunicode}
\defaultfontfeatures{Mapping=tex-text,Scale=MatchLowercase}

\usepackage{pslatex} % like times, but with narrower courier
\usepackage{color} % gives us \definecolor
%% Used for sidebars
\usepackage{framed}
\usepackage{marginnote}

%% gives us smaller margins
\usepackage{fullpage}

%% Space below the header (http://en.wikibooks.org/wiki/LaTeX/Page_Layout)
\setlength{\headsep}{0.3in}

%% Space above header
\setlength{\topmargin}{0.0in}

%% Adds some extra symbols, notably the pipe (|)
\usepackage{eurosym}
\usepackage[T1]{fontenc}

%% gives you 1/4, 1/2, degree, etc
\usepackage{textcomp}

%% Set the font for section and chapter headings
%% http://www.kronto.org/thesis/tips/section-title.html
\usepackage{sectsty}
\allsectionsfont{\sffamily}

%% Used for turning off hyphenation in section titles
\usepackage{hyphenat}

%% Use the figure package to place floats exactly where they are in the text, if you give them the H param.
%% like this:
%% \begin{figure}[H] 
%% <whatever> 
%% \end{figure} 
\usepackage{float}

\usepackage{listings}


%% 
\usepackage{graphicx}
% We will generate all images so they have a width \maxwidth. This means
% that they will get their normal width if they fit onto the page, but
% are scaled down if they would overflow the margins.
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
\else\Gin@nat@width\fi}
\makeatother
\let\Oldincludegraphics\includegraphics
\renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=\maxwidth]{#1}}

\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
\renewcommand{\chaptername}{} % Turn off 'Chapter N' before all chapters
\renewcommand{\thechapter}{} % Turn off chapter numbering

%% The standard Latex headers go
%% \chaptername\ \thechapter.\ The actual Name of the chapter
%% since we've turned \chaptername and \thechapter to empty spaces, this results
%% in: `. The actual name of the chapter`. We fix this with the fancy headers package.

\setlength{\headheight}{12pt}
%% Headers
%% http://mirror.its.dal.ca/ctan/macros/latex/contrib/fancyhdr/fancyhdr.pdf
%% http://www.kronto.org/thesis/tips/custom-headers.html
\usepackage{fancyhdr}
\pagestyle{fancy}

%% Now begin customising things. See the fancyhdr docs for more info.
\renewcommand{\chaptermark}[1]{\markboth{\MakeUppercase{#1}}{}}
\renewcommand{\sectionmark}[1]{\markright{\MakeUppercase{#1}}{}}
\renewcommand{\headrulewidth}{0pt}

%% Configuration of the header strings for the frontmatter pages.
\fancyhead[LO]{\footnotesize\leftmark}
\fancyhead[RO]{\thepage}
\fancyfoot{}

%% End of fancy headers

%% Make the footnotes the same font family as the main text

%% urlstyle (provided by the url package) allows you to change the font on urls
\usepackage{url}
\urlstyle{rm}

%% change the size of the footnotes
\usepackage{footmisc}
\renewcommand*{\footnotelayout}{\scriptsize\rmfamily}

%% Warnings
\newenvironment{warning}
  {  
    \begin{quote}
      \reversemarginpar %% Put margin notes on the left side
      \marginnote{\Oldincludegraphics[width=1.0cm]{/var/lpub/releases/20110709211220/book_generator/assets/warning.png}}
   }
  {\end{quote}}

%% Tips
\newenvironment{tip}
  {
    \begin{quote}
      \reversemarginpar
      \marginnote{\Oldincludegraphics[width=1.0cm]{/var/lpub/releases/20110709211220/book_generator/assets/tip.png}}
  }
  {\end{quote}}

%% Top margin above a chapter
%% http://en.wikibooks.org/wiki/LaTeX/Page_Layout#Top_margin_above_Chapter
\usepackage{titlesec}
\titlespacing*{\chapter}{0pt}{-100pt}{20pt}
\titleformat{\chapter}[display]{\huge\sffamily\bfseries}{\thechapter}{20pt}{\Huge\hyphenpenalty=10000\tolerance=1000}

%% Margin above a section is 30pt.
%% hyphenpenalty and tolerance turn off hyphenation
%% See http://mirror.its.dal.ca/ctan/macros/latex/contrib/titlesec/titlesec.pdf for more info
%% \titlespacing*{\section}{left}{above}{below}
\titleformat{\section}[display]{\huge\sffamily\bfseries}{\thechapter}{30pt}{\LARGE\hyphenpenalty=10000\tolerance=1000}
\titlespacing*{\section}{0pt}{30pt}{0pt}

% eso-pic provides the full page background image we use for the title page (AddToShipoutPicture*)
\usepackage{eso-pic} 

\usepackage[labelformat=empty]{caption} % get rid of captions below images


\setcounter{secnumdepth}{0}

\title{The Node Beginner Book}
\author{Manuel Kiessling}
\date{Sun Jul 10 09:42:20 +0000 2011}

%% The hyperref package needs to be right before \begin{document}, otherwise the PDF bookmarks don't go to the right place.
\usepackage[hyperfootnotes=true,breaklinks=true,unicode=true,colorlinks=true,urlcolor=black,linkcolor=black]{hyperref}

\begin{document}

\pagenumbering{roman}

% The main title page

\begin{titlepage}
.
\AddToShipoutPicture*{
  \put(0,0){\Oldincludegraphics[width=\paperwidth,height=\paperheight]{/var/lpub/shared/book_repos/nodebeginner/manuscript/images/title_page.png}}
}
\end{titlepage}


% The verso title page
\begin{titlepage}
  \LARGE{\sffamily \bfseries The Node Beginner Book: A comprehensive Node.js tutorial }
  \\[0.2cm]
  \normalsize{\copyright \the\year{} Manuel Kiessling}
  \\[1cm]

  \Oldincludegraphics[width=2.5cm]{/var/lpub/releases/20110709211220/book_generator/assets/leanpub_logo.png}
\\[1cm]
  \normalsize{This is a Leanpub book which is for sale at http://leanpub.com. 

Leanpub
helps you connect with readers and sell your ebook, while you're writing it
and after it's done.}
\end{titlepage}


\setcounter{tocdepth}{1}
\pdfbookmark[1]{Contents}{table}
\tableofcontents


\pagebreak
\pagenumbering{arabic}

\input{wholebook}

\end{document}

 INFO book_generator_log: generating PDF from latex
 INFO book_generator_log: cmd: cd /var/lpub/shared/book_repos/nodebeginner/html_bodies_latex && xelatex --jobname=nodebeginner --output-directory=/var/lpub/shared/book_repos/nodebeginner/output --halt-on-error --interaction=errorstopmode book-full.tex >> /tmp/xelatex.log 2>&1
 INFO book_generator_log: exit status: 0
 INFO book_generator_log: back from generate pdf
 INFO book_generator_log: generated title page
 INFO book_generator_log: uploading generated title page to S3
 INFO book_generator_log: putting file on S3 at titlepages.leanpub.com/tmp/nodebeginner-title_page.png with options {:access=>:public_read, "Content-Disposition"=>"attachment; filename=nodebeginner-title_page.png"}
 INFO book_generator_log: ****** Manifest#generate_epub_and_mobi, epub filename: nodebeginner.epub, mobi filename: nodebeginner.mobi, sample: false
 INFO book_generator_log: cd /var/lpub/shared/book_repos/nodebeginner && /var/lpub/usr/local/bin/pandoc --epub-metadata=/var/lpub/shared/book_repos/nodebeginner/metadata.xml --epub-stylesheet=/var/lpub/releases/20110709211220/book_generator/pandoc_templates/epub.css --from=html --to=epub --sanitize-html --standalone --output=/var/lpub/shared/book_repos/nodebeginner/output/nodebeginner.epub /var/lpub/shared/book_repos/nodebeginner/html_bodies/book-full.html
 INFO book_generator_log: generate_mobi: cd /var/lpub/shared/book_repos/nodebeginner/output && /var/lpub/current/book_generator/bin/kindlegen nodebeginner.epub -o nodebeginner.mobi
ERROR book_generator_log: Command failed with status: 256 (cd /var/lpub/shared/book_repos/nodebeginner/output && /var/lpub/current/book_generator/bin/kindlegen nodebeginner.epub -o nodebeginner.mobi)
ERROR book_generator_log: 
***********************************************
* Amazon.com kindlegen(Linux)   V1.1 build 99 *
* A command line e-book compiler              *
* Copyright Amazon.com 2010                   *
***********************************************

opt -o:  output file name
opt version: try to minimize (default)
Info(prcgen): Added metadata dc:Title        "The Node Beginner Book: A comprehensive Node.js tutorial"
Info(prcgen): Added metadata dc:Creator      "Manuel Kiessling"
Info(prcgen): Parsing files  0000006
Info(prcgen): Resolving hyperlinks
Info(prcgen): Building table of content     URL: /tmp/filesDt9nf/toc.ncx
Warning(prcgen): Cover not specified
Info(prcgen): Computing UNICODE ranges used in the book
Info(prcgen): Found UNICODE range: Basic Latin [20..7E]
Info(prcgen): Building MOBI file, record count:   0000024
Info(prcgen): Compiling HTML Parser restart information
Info(prcgen): Final stats - text compressed to (in % of original size):  046.98%
Info(prcgen): The document identifier is: "The_Node_Beg-de.js_tutorial"
Info(prcgen): The file format version is V6
Info(prcgen): Saving MOBI file
Info(prcgen): MOBI File generated with WARNINGS!

ERROR book_generator_log: 
 INFO book_generator_log: putting file on S3 at downloads.leanpub.com/nodebeginner.pdf with options {"Content-Disposition"=>"attachment; filename=nodebeginner.pdf"}
 INFO book_generator_log: putting file on S3 at downloads.leanpub.com/nodebeginner.epub with options {"Content-Disposition"=>"attachment; filename=nodebeginner.epub"}
 INFO book_generator_log: putting file on S3 at downloads.leanpub.com/nodebeginner.mobi with options {"Content-Disposition"=>"attachment; filename=nodebeginner.mobi"}
DEBUG book_generator_log: [git] reading manuscript/Sample.txt (path: /var/lpub/shared/book_repos/nodebeginner)
